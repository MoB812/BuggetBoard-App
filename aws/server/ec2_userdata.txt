#!/bin/bash

# Update and install Nodejs,Git
yum update -y
sudo su
curl -sL https://rpm.nodesource.com/setup_14.x | sudo bash -
sudo yum install -y nodejs
sudo yum install -y git

# Create server directory and download NodeJS server files from GitHub repo
mkdir app-server && cd app-server
git init
git remote add origin -f https://github.com/MoB812/BuggetBoard-App.git
git config core.sparseCheckout true
echo "/aws/server" > .git/info/sparse-checkout
cd aws/server

# Download Angular dist files from S3
aws s3 sync s3://buggetboard.com dist

# Install Node Dependencies
npm install

# Run server on port 3000
node server.js
